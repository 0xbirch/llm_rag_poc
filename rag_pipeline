import sqlite3
import pandas as pd
import os 


def load_trade_signals(csv_file_path, database_name, table_name):
    df = pd.DataFrame()

    for file in os.listdir(csv_file_path):
        if file.endswith('.csv'):
            file_path = os.path.join(csv_file_path, file)
            df = pd.concat([df, pd.read_csv(file_path)], ignore_index=True)
    print(f"Loaded {len(df)} rows from {csv_file_path}")

    conn = sqlite3.connect(database_name)
    df.to_sql(table_name, conn, if_exists="replace", index=False)

    df = pd.read_sql_query(f"SELECT * FROM {table_name};", conn)
    print(f"Loaded table from {table_name}")
    print(df.head())
    conn.close()


load_trade_signals("rag_data/trades", "rag_poc_database.db", "trades")